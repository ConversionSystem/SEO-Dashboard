<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Local SEO Real-Time Optimizer - ConversionSystem</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios@1.6.0/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1.11.10/dayjs.min.js"></script>
    <link href="/static/styles.css" rel="stylesheet">
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center">
                    <h1 class="text-2xl font-bold text-blue-600">
                        <i class="fas fa-map-marked-alt mr-2"></i>
                        Local SEO Real-Time Optimizer
                    </h1>
                </div>
                <div class="flex items-center space-x-4">
                    <button onclick="toggleAutoRefresh()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                        <i class="fas fa-sync-alt mr-2"></i>
                        <span id="autoRefreshStatus">Auto-Refresh: ON</span>
                    </button>
                    <a href="/dashboard.html" class="text-gray-600 hover:text-gray-800">
                        <i class="fas fa-arrow-left mr-2"></i>Back to Dashboard
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Real-Time Status Bar -->
    <div class="bg-gradient-to-r from-blue-500 to-purple-600 text-white py-3">
        <div class="container mx-auto px-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-6">
                    <div class="flex items-center">
                        <div class="w-3 h-3 bg-green-400 rounded-full animate-pulse mr-2"></div>
                        <span class="text-sm">Live Monitoring Active</span>
                    </div>
                    <div class="text-sm">
                        <i class="fas fa-clock mr-1"></i>
                        Last Update: <span id="lastUpdateTime">--:--:--</span>
                    </div>
                </div>
                <div class="flex items-center space-x-4 text-sm">
                    <span><i class="fas fa-bell mr-1"></i>Alerts: <span id="alertCount">0</span></span>
                    <span><i class="fas fa-chart-line mr-1"></i>Changes: <span id="changeCount">0</span></span>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container mx-auto px-6 py-8">
        <!-- Quick Actions -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <h2 class="text-xl font-bold mb-4">
                <i class="fas fa-bolt text-yellow-500 mr-2"></i>
                Quick Actions
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <button onclick="scanGMB()" class="bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 transition">
                    <i class="fas fa-store mr-2"></i>Scan GMB Profile
                </button>
                <button onclick="checkCompetitors()" class="bg-purple-600 text-white px-4 py-3 rounded-lg hover:bg-purple-700 transition">
                    <i class="fas fa-users mr-2"></i>Check Competitors
                </button>
                <button onclick="analyzeReviews()" class="bg-green-600 text-white px-4 py-3 rounded-lg hover:bg-green-700 transition">
                    <i class="fas fa-star mr-2"></i>Analyze Reviews
                </button>
                <button onclick="findCitations()" class="bg-orange-600 text-white px-4 py-3 rounded-lg hover:bg-orange-700 transition">
                    <i class="fas fa-link mr-2"></i>Find Citations
                </button>
            </div>
        </div>

        <!-- Real-Time Metrics Grid -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <!-- GMB Visibility -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="font-semibold text-gray-700">GMB Visibility</h3>
                    <span class="text-2xl">üè™</span>
                </div>
                <div class="text-3xl font-bold text-blue-600 mb-2">
                    <span id="gmbVisibility">--</span>%
                </div>
                <div class="flex items-center text-sm">
                    <span id="gmbChange" class="text-green-600">
                        <i class="fas fa-arrow-up mr-1"></i>+0%
                    </span>
                    <span class="text-gray-500 ml-2">vs last hour</span>
                </div>
                <div class="mt-4">
                    <canvas id="gmbMiniChart" height="60"></canvas>
                </div>
            </div>

            <!-- Local Pack Ranking -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="font-semibold text-gray-700">Local Pack Rank</h3>
                    <span class="text-2xl">üìç</span>
                </div>
                <div class="text-3xl font-bold text-purple-600 mb-2">
                    #<span id="localPackRank">--</span>
                </div>
                <div class="flex items-center text-sm">
                    <span id="packChange" class="text-green-600">
                        <i class="fas fa-arrow-up mr-1"></i>Improved
                    </span>
                    <span class="text-gray-500 ml-2">real-time</span>
                </div>
                <div class="mt-4">
                    <div class="space-y-1">
                        <div class="flex justify-between text-xs">
                            <span>Map Pack</span>
                            <span id="mapPackStatus" class="font-semibold">--</span>
                        </div>
                        <div class="flex justify-between text-xs">
                            <span>Organic</span>
                            <span id="organicStatus" class="font-semibold">--</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Review Score -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="font-semibold text-gray-700">Review Score</h3>
                    <span class="text-2xl">‚≠ê</span>
                </div>
                <div class="text-3xl font-bold text-green-600 mb-2">
                    <span id="reviewScore">--</span>
                </div>
                <div class="flex items-center text-sm">
                    <span id="reviewCount" class="text-gray-600">
                        0 reviews
                    </span>
                    <span class="text-gray-500 ml-2">monitoring</span>
                </div>
                <div class="mt-4">
                    <div class="flex items-center space-x-1">
                        <i class="fas fa-star text-yellow-400"></i>
                        <i class="fas fa-star text-yellow-400"></i>
                        <i class="fas fa-star text-yellow-400"></i>
                        <i class="fas fa-star text-yellow-400"></i>
                        <i class="fas fa-star-half-alt text-yellow-400"></i>
                    </div>
                    <div class="text-xs text-gray-500 mt-1">
                        <span id="newReviews">0 new today</span>
                    </div>
                </div>
            </div>

            <!-- Citation Health -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="font-semibold text-gray-700">Citation Health</h3>
                    <span class="text-2xl">üîó</span>
                </div>
                <div class="text-3xl font-bold text-orange-600 mb-2">
                    <span id="citationScore">--</span>%
                </div>
                <div class="flex items-center text-sm">
                    <span id="citationStatus" class="text-green-600">
                        <i class="fas fa-check-circle mr-1"></i>Healthy
                    </span>
                    <span class="text-gray-500 ml-2">NAP consistent</span>
                </div>
                <div class="mt-4">
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div id="citationBar" class="bg-orange-600 h-2 rounded-full" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Tabs -->
        <div class="bg-white rounded-lg shadow-lg">
            <div class="border-b border-gray-200">
                <nav class="flex -mb-px">
                    <button onclick="switchTab('gmb')" class="tab-btn active px-6 py-3 text-sm font-medium">
                        <i class="fas fa-store mr-2"></i>GMB Insights
                    </button>
                    <button onclick="switchTab('rankings')" class="tab-btn px-6 py-3 text-sm font-medium">
                        <i class="fas fa-map mr-2"></i>Local Rankings
                    </button>
                    <button onclick="switchTab('competitors')" class="tab-btn px-6 py-3 text-sm font-medium">
                        <i class="fas fa-users mr-2"></i>Competitors
                    </button>
                    <button onclick="switchTab('reviews')" class="tab-btn px-6 py-3 text-sm font-medium">
                        <i class="fas fa-star mr-2"></i>Reviews
                    </button>
                    <button onclick="switchTab('citations')" class="tab-btn px-6 py-3 text-sm font-medium">
                        <i class="fas fa-link mr-2"></i>Citations
                    </button>
                    <button onclick="switchTab('alerts')" class="tab-btn px-6 py-3 text-sm font-medium">
                        <i class="fas fa-bell mr-2"></i>Alerts
                    </button>
                </nav>
            </div>

            <!-- Tab Content -->
            <div class="p-6">
                <!-- GMB Insights Tab -->
                <div id="gmb-tab" class="tab-content">
                    <h3 class="text-xl font-bold mb-6">
                        <i class="fas fa-store text-blue-600 mr-2"></i>
                        Google My Business Real-Time Insights
                    </h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <!-- Search Queries -->
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h4 class="font-semibold mb-4">Top Search Queries (Live)</h4>
                            <div class="space-y-2" id="searchQueries">
                                <div class="flex justify-between items-center">
                                    <span class="text-sm">Loading...</span>
                                    <span class="text-xs text-gray-500">--</span>
                                </div>
                            </div>
                        </div>

                        <!-- Customer Actions -->
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h4 class="font-semibold mb-4">Customer Actions (Today)</h4>
                            <div class="space-y-3" id="customerActions">
                                <div class="flex justify-between items-center">
                                    <span class="text-sm"><i class="fas fa-phone text-green-600 mr-2"></i>Calls</span>
                                    <span class="font-bold">--</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm"><i class="fas fa-directions text-blue-600 mr-2"></i>Directions</span>
                                    <span class="font-bold">--</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm"><i class="fas fa-globe text-purple-600 mr-2"></i>Website Clicks</span>
                                    <span class="font-bold">--</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- GMB Performance Chart -->
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h4 class="font-semibold mb-4">24-Hour Performance Trend</h4>
                        <canvas id="gmbPerformanceChart" height="80"></canvas>
                    </div>
                </div>

                <!-- Local Rankings Tab -->
                <div id="rankings-tab" class="tab-content hidden">
                    <h3 class="text-xl font-bold mb-6">
                        <i class="fas fa-map text-purple-600 mr-2"></i>
                        Real-Time Local Rankings Monitor
                    </h3>

                    <!-- Location-Based Rankings -->
                    <div class="mb-6">
                        <div class="flex items-center justify-between mb-4">
                            <h4 class="font-semibold">Location-Based Rankings</h4>
                            <button onclick="refreshRankings()" class="text-blue-600 hover:text-blue-800">
                                <i class="fas fa-sync-alt mr-1"></i>Refresh Now
                            </button>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Keyword</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Location</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Map Pack</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Organic</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Change</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Updated</th>
                                    </tr>
                                </thead>
                                <tbody id="localRankingsTable" class="divide-y divide-gray-200">
                                    <tr>
                                        <td colspan="6" class="px-4 py-3 text-center text-gray-500">Loading rankings...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Rankings Map -->
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h4 class="font-semibold mb-4">Geographic Ranking Distribution</h4>
                        <div id="rankingsMap" class="h-64 bg-gray-200 rounded flex items-center justify-center">
                            <span class="text-gray-500">Map visualization coming soon</span>
                        </div>
                    </div>
                </div>

                <!-- Competitors Tab -->
                <div id="competitors-tab" class="tab-content hidden">
                    <h3 class="text-xl font-bold mb-6">
                        <i class="fas fa-users text-orange-600 mr-2"></i>
                        Live Competitor Tracking
                    </h3>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <!-- Competitor Rankings -->
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h4 class="font-semibold mb-4">Competitor Performance</h4>
                            <div id="competitorList" class="space-y-3">
                                <div class="text-gray-500">Loading competitors...</div>
                            </div>
                        </div>

                        <!-- Share of Voice -->
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h4 class="font-semibold mb-4">Local Share of Voice</h4>
                            <canvas id="shareOfVoiceChart" height="200"></canvas>
                        </div>
                    </div>

                    <!-- Competitor Alerts -->
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                        <h4 class="font-semibold mb-2 text-yellow-800">
                            <i class="fas fa-exclamation-triangle mr-2"></i>
                            Competitor Alerts
                        </h4>
                        <div id="competitorAlerts" class="space-y-2">
                            <div class="text-sm text-yellow-700">No new competitor activities detected</div>
                        </div>
                    </div>
                </div>

                <!-- Reviews Tab -->
                <div id="reviews-tab" class="tab-content hidden">
                    <h3 class="text-xl font-bold mb-6">
                        <i class="fas fa-star text-green-600 mr-2"></i>
                        Real-Time Review Monitoring
                    </h3>

                    <!-- Review Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div class="bg-green-50 rounded-lg p-4">
                            <div class="text-sm text-green-600 mb-1">Average Rating</div>
                            <div class="text-2xl font-bold">4.5 ‚≠ê</div>
                        </div>
                        <div class="bg-blue-50 rounded-lg p-4">
                            <div class="text-sm text-blue-600 mb-1">Total Reviews</div>
                            <div class="text-2xl font-bold">342</div>
                        </div>
                        <div class="bg-purple-50 rounded-lg p-4">
                            <div class="text-sm text-purple-600 mb-1">Response Rate</div>
                            <div class="text-2xl font-bold">87%</div>
                        </div>
                    </div>

                    <!-- Recent Reviews -->
                    <div class="bg-gray-50 rounded-lg p-4 mb-6">
                        <h4 class="font-semibold mb-4">Latest Reviews (Live Feed)</h4>
                        <div id="reviewsFeed" class="space-y-4">
                            <div class="border-l-4 border-green-500 pl-4">
                                <div class="flex items-center justify-between mb-1">
                                    <span class="font-semibold">John D.</span>
                                    <span class="text-sm text-gray-500">2 minutes ago</span>
                                </div>
                                <div class="flex items-center mb-2">
                                    <i class="fas fa-star text-yellow-400"></i>
                                    <i class="fas fa-star text-yellow-400"></i>
                                    <i class="fas fa-star text-yellow-400"></i>
                                    <i class="fas fa-star text-yellow-400"></i>
                                    <i class="fas fa-star text-yellow-400"></i>
                                </div>
                                <p class="text-sm text-gray-700">Excellent service! Very professional team.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Sentiment Analysis -->
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h4 class="font-semibold mb-4">Sentiment Analysis</h4>
                        <canvas id="sentimentChart" height="60"></canvas>
                    </div>
                </div>

                <!-- Citations Tab -->
                <div id="citations-tab" class="tab-content hidden">
                    <h3 class="text-xl font-bold mb-6">
                        <i class="fas fa-link text-orange-600 mr-2"></i>
                        Citation Monitoring & Management
                    </h3>

                    <!-- Citation Summary -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                        <div class="bg-green-50 rounded-lg p-4 text-center">
                            <div class="text-2xl font-bold text-green-600">45</div>
                            <div class="text-sm text-gray-600">Consistent</div>
                        </div>
                        <div class="bg-yellow-50 rounded-lg p-4 text-center">
                            <div class="text-2xl font-bold text-yellow-600">12</div>
                            <div class="text-sm text-gray-600">Needs Update</div>
                        </div>
                        <div class="bg-red-50 rounded-lg p-4 text-center">
                            <div class="text-2xl font-bold text-red-600">3</div>
                            <div class="text-sm text-gray-600">Incorrect</div>
                        </div>
                        <div class="bg-blue-50 rounded-lg p-4 text-center">
                            <div class="text-2xl font-bold text-blue-600">8</div>
                            <div class="text-sm text-gray-600">Opportunities</div>
                        </div>
                    </div>

                    <!-- Citation List -->
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h4 class="font-semibold mb-4">Citation Sources</h4>
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead>
                                    <tr class="border-b">
                                        <th class="text-left py-2 text-sm font-medium text-gray-700">Directory</th>
                                        <th class="text-left py-2 text-sm font-medium text-gray-700">Status</th>
                                        <th class="text-left py-2 text-sm font-medium text-gray-700">NAP Consistency</th>
                                        <th class="text-left py-2 text-sm font-medium text-gray-700">Action</th>
                                    </tr>
                                </thead>
                                <tbody id="citationsTable">
                                    <tr>
                                        <td class="py-2">Yelp</td>
                                        <td class="py-2"><span class="text-green-600">‚úì Listed</span></td>
                                        <td class="py-2"><span class="text-green-600">100%</span></td>
                                        <td class="py-2"><button class="text-blue-600 hover:text-blue-800">View</button></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Alerts Tab -->
                <div id="alerts-tab" class="tab-content hidden">
                    <h3 class="text-xl font-bold mb-6">
                        <i class="fas fa-bell text-red-600 mr-2"></i>
                        Real-Time Alerts & Notifications
                    </h3>

                    <div id="alertsList" class="space-y-4">
                        <!-- Alerts will be dynamically added here -->
                        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="font-semibold text-blue-800">System Active</div>
                                    <div class="text-sm text-blue-600 mt-1">Real-time monitoring is active and checking for updates.</div>
                                </div>
                                <span class="text-xs text-gray-500">Now</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/real-time-local-seo.js"></script>
</body>
</html>